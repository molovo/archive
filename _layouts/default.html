{% capture currentURL %}{{ page.url | replace: '/', ' ' | truncatewords: 1 | remove: '...' | remove: ' ' }}{% endcapture %}

{% if currentURL == 'index.html' %}
  {% assign bodyClass = 'home' %}
{% else %}
  {% assign bodyClass = currentURL %}
{% endif %}

<!DOCTYPE html>
<html>
  <head>
    <link rel="dns-prefetch" href="//use.typekit.net" />
    <link rel="dns-prefetch" href="//p.typekit.net" />
    <link rel="dns-prefetch" href="//hello.myfonts.net" />
    <link rel="dns-prefetch" href="//www.google-analytics.com" />

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1">
    <title>{% if page.title %}{{ page.title}} - {% endif %}molovo. Web Design, Portsmouth</title>

    <script>
      (function (d) {
        function addFont() {
          var style = d.createElement( 'style' );
          style.rel = 'stylesheet';
          d.head.appendChild( style );
          style.textContent = localStorage.gauthier;
        }

        try {
          if ( localStorage.gauthier ) {
            // The font is in localStorage, we can load it directly
            addFont();
          } else {
            // We have to first load the font file asynchronously
            var request = new XMLHttpRequest();
            request.open( 'GET', '/assets/fonts/gauthier_fy/molovo.css', true );

            request.onload = function () {
              if ( request.status >= 200 && request.status < 400 ) {
                // We save the file in localStorage
                localStorage.gauthier = request.responseText;

                // ... and load the font
                addFont();
              }
            }

            request.send();
          }
        } catch ( ex ) {
          // maybe load the font synchronously for woff-capable browsers
          // to avoid blinking on every request when localStorage is not available
          var link = d.createElement( 'link' );
          link.rel = 'stylesheet';
          link.href = '/assets/fonts/gauthier_fy/molovo.css';
          d.head.appendChild( link );
        }
      }(document));
    </script>

    <link rel="shortcut icon" href="/assets/dist/img/favicon.png" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/assets/dist/css/main.min.css" />

    <!-- Load font kits for case studies that use them -->
    {% if page.typography.uses_kit %}
      <link rel="stylesheet" href="/assets/fonts/case-studies/{{ page.slug }}/kit.css" />
    {% endif %}

    {% if page.url == '/blog/index.html' %}
      <meta name="robots" content="noindex,follow">
    {% endif %}

    {% if page.excerpt %}
      <meta name="description" content="{{ page.excerpt | escape }}">
    {% endif %}

    <script src="//use.typekit.net/xly4ucd.js" async defer
      onload="Typekit.load();">
    </script>
    <script src="https://www.google-analytics.com/analytics.js" async defer></script>
  </head>

  <body class="{{ bodyClass }}">

    <header class="fixed {% if 'home contact work' contains bodyClass %}transparent{% endif %} {% if page.headerClass %}{{ page.headerClass }}{% endif %}">

      <nav class="work">
        <nav class="main-menu">
          <a href="//jamesdinsdale.me" id="about-link" target="_blank">CV / Résumé</a>
          <a href="/blog" id="writing-link">Writing</a>
          <a href="/contact" id="hire-me-link">Hire Me</a>
        </nav>

        <hgroup>
          <h3 class="serif">Selected project stories&hellip;</h3>
        </hgroup>

        <ul class="center">
          {% for job in site.categories.work %}
            <li class="{{ job.slug }}">
              <a href="{{ job.url }}" title="{{ job.title }}">
                <div class="container">
                  <h2>{{ job.title }}</h2>
                  <h6><em>The making of {{ job.client }}</em></h6>
                </div>
              </a>
            </li>
          {% endfor %}
        </ul>
      </nav>

      <nav class="main">
        <!-- <a href="/" class="logo">&lt;/m&gt;</a> -->
        <a href="/" class="logo" id="home-link">
          {% include icons/logo.svg %}
        </a>

        <a href="#work" id="work-link">
          <span class="lines-button x" type="button" role="button" aria-label="Toggle Navigation">
            <span class="lines"></span>
          </span>
        </a>
      </nav>

    </header>

    {{ content }}

    <section class="featured-case-study intro" id="featured-case-study"></section>

    <script id="case-study-template" type="text/template">
      {% raw %}
      <div class="container intro-container">
        <h2 class="serif">
          {{ intro }}
        </h2>
        <a href="/work/{{ slug }}" class="button">View the Case Study</a>
      </div>
      {% endraw %}
    </script>

    <footer class="bottom">
      <div class="container center">
        <div class="left">
          <div class="first">
            <a href="/" class="logo">
              {% include icons/logo.svg %}<h6 class="upp">Made in the UK.</h6>
            </a>
          </div>

          <div class="second">
            <p>&copy; 2014 molovo</p>
          </div>

          <div class="third">
            <a href="mailto:hi@molovo.co.uk">
              hi@molovo.co.uk</a>
          </div>
        </div>

        <a href="/contact" class="right footer-contact-link">
          {% include icons/mail.svg %}
          Ready to talk? &rarr;
        </a>
      </div>
    </footer>

    <script src="/assets/dist/js/main.min.js" async defer></script>

    {% if currentURL == 'work' %}
      <script src="//use.typekit.net/ace7wjo.js" async defer
        onload="Typekit.load();"></script>
    {% endif %}

  </body>
</html>
